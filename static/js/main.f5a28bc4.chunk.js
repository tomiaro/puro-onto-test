(this["webpackJsonppuro-onto"]=this["webpackJsonppuro-onto"]||[]).push([[0],{380:function(e,t,n){e.exports=n(869)},387:function(e,t,n){},392:function(e,t){},394:function(e,t){},427:function(e,t){},428:function(e,t){},658:function(e,t,n){var r={"./locale":304,"./locale.js":304};function o(e){var t=l(e);return n(t)}function l(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=l,e.exports=o,o.id=658},672:function(e,t){},674:function(e,t){},684:function(e,t,n){var r={"./N3Lexer":182,"./N3Lexer.js":182,"./N3Parser":183,"./N3Parser.js":183,"./N3Store":317,"./N3Store.js":317,"./N3StreamParser":318,"./N3StreamParser.js":318,"./N3StreamWriter":319,"./N3StreamWriter.js":319,"./N3Util":184,"./N3Util.js":184,"./N3Writer":185,"./N3Writer.js":185};function o(e){var t=l(e);return n(t)}function l(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=l,e.exports=o,o.id=684},689:function(e,t){},706:function(e,t){},712:function(e,t){},725:function(e,t){},726:function(e,t){},736:function(e,t){},738:function(e,t){},811:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=811},867:function(e,t,n){e.exports=n.p+"static/media/model.7c8b6791.PNG"},869:function(e,t,n){"use strict";n.r(t);var r=n(378),o=n(0),l=n(1),i=n(5),a=n(6),s=n(7),u=n(2),h=n.n(u),c=n(373),d=n.n(c),p=(n(385),n(386),n(387),n(56)),y=n.n(p),f=n(374),v=n.n(f),m=n(203),g=n.n(m),T=n(17),b=n.n(T),O=n(88),E=function e(){var t,r=this;Object(o.a)(this,e),this.getRelatorBtype=function(e,t){var n="\n            PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n            PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n            SELECT ?element ?valuation ?elementLabel ?type ?father ?fatherLabel ?elementType ?fatherType WHERE \n            {\n                {<"+e+"> puro:linkedTo ?element . <"+t+"> puro:linkedTo <"+e+">} \n                UNION\n                {?element puro:linkedTo <"+e+"> . <"+e+"> puro:linkedTo <"+t+">}    \n                {?element a puro:BObject}\n                UNION\n                {?element a puro:BType}\n                ?element rdfs:label ?elementLabel .\n                ?element a ?elementType .  \n                OPTIONAL {?element puro:instanceOf ?father}\n                OPTIONAL {?father rdfs:label ?fatherLabel}\n                OPTIONAL {?father a ?fatherType}\n                OPTIONAL {?uri puro:linkedTo ?valuation. ?valuation a puro:BValuation}\n               \n               \n            }";return new Promise((function(t){r.sparqlQuery(n,(function(n){(n=this.deleteDuplicity(n,["valuation"])).relationName=e,t(n)}))}))},this.findBTypeRelation=function(e,t,n){var o=e.uri.value,l="\n             PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n             PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n             SELECT ?uri ?label ?father ?fatherType ?type ?fatherTypeRelation ?connect ?connectFrom ?child ?childType ?childRel WHERE \n             {\n                 {<"+o+"> puro:instanceOf ?uri }\n                 UNION\n                 {<"+o+"> puro:subTypeOf  ?uri }\n                 ?uri a ?type . \n                 ?uri rdfs:label ?label . \n                \n             }";r.sparqlQuery(l,function(e){if(!((e=this.deleteDuplicity(e,["connect","connectFrom","father","fatherType","fatherTypeRelation","child","childType","childRel"])).length>0))return n(t),t;for(var r in e)t.push(e[r]),this.findBTypeRelation(e[r],t,n)}.bind(r))},this.findBTypeChild=function(e,t,n){var o=e.uri.value,l="\n                 PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                 PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                 SELECT ?uri ?valuation ?valuationLabel ?label ?father ?fatherType ?type ?fatherTypeRelation ?connect ?connectFrom ?child ?childType ?childRel WHERE \n                 {\n                     {?uri puro:instanceOf <"+o+">}\n                     UNION\n                     {?uri puro:subTypeOf <"+o+">}\n                     OPTIONAL {{?child puro:instanceOf ?uri} UNION {?child puro:subTypeOf ?uri}}\n                     OPTIONAL {?child a ?childType}\n                     OPTIONAL {{?child ?childRel ?uri} UNION {?child ?childRel ?uri}}\n                     OPTIONAL {?uri puro:linkedTo ?valuation. ?valuation a puro:BValuation}\n                     ?uri ?fatherTypeRelation <"+o+"> .\n                     ?uri rdfs:label ?label .\n                     ?uri a ?type . \n                     <"+o+"> a ?fatherType\n                     OPTIONAL {?uri puro:linkedTo ?connect. ?connect a puro:BRelation}\n                     OPTIONAL {?connectFrom puro:linkedTo ?uri. ?connectFrom a puro:BRelaion}\n                     BIND ( <"+o+">  AS ?father)\n                 }";r.sparqlQuery(l,function(e){if(!((e=this.deleteDuplicity(e,["connect","connectFrom","father","fatherType","fatherTypeRelation","child","childType","childRel","valuation"])).length>0))return n(t),t;for(var r in e)t.push(e[r]),this.findBTypeChild(e[r],t,n)}.bind(r))},this.getFullPath=function(){return new Promise((function(e){r.sparqlQuery("\n                 PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                 PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                 SELECT ?uri ?valuation ?label ?type ?connect ?child ?fatherType ?father ?fatherTypeRelation ?childType ?childRel WHERE \n                 {\n                     ?uri rdfs:label ?label .\n                     ?uri a puro:BType . \n                     ?uri a ?type\n                     OPTIONAL {{?child puro:instanceOf ?uri} UNION {?child puro:subTypeOf ?uri} ?child a ?childType . ?child ?childRel ?uri . } \n                     OPTIONAL {?uri puro:linkedTo ?connect. ?connect a puro:BRelation}\n                     OPTIONAL {?uri puro:linkedTo ?valuation. ?valuation a puro:BValuation}\n                     FILTER NOT EXISTS {?uri puro:subTypeOf ?object}\n                     FILTER NOT EXISTS {?uri puro:instanceOf ?object}\n                 }",function(t){t.forEach((function(e){e.father=[],e.fatherType=[],e.fatherTypeRelation=[],e.connectFrom=[]})),this.deleteDuplicity(t,["valuation","connect","childType","child","childRel"]),this.recursiveFindChild(0,t,[],(function(t){e(t)}))}.bind(r))}))},this.recursiveFindChild=function(e,t,n,o,l){if(e===t.length)return o(n),n;n.push(t[e]),"relation"===l?r.findBTypeRelation(t[e],n,function(r){e++,this.recursiveFindChild(e++,t,n,o,"relation")}.bind(r)):r.findBTypeChild(t[e],n,function(r){e++,this.recursiveFindChild(e++,t,n,o,l)}.bind(r))},this.sparqlQuery=function(e,t){var o=r.puroXML;o=(new XMLSerializer).serializeToString(o);var l,i=r.rdf.graph();r.rdf.parse(o,i,"http://lod2-dev.vse.cz/","application/rdf+xml"),r.rdf.serialize(void 0,i,"http://www.w3sds.org/1999/02/22-rdf-syntax-ns#type","text/turtle",(function(e,t){l=t})),n(665).create((function(n,r){r.load("text/turtle",l,(function(n,o){r.execute(e,(function(e,n){t(n)}))}))}))},this.getRelationBTypes=function(e){var t="\n                 PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                 PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                 SELECT  ?uri ?type ?label  WHERE \n                 {\n                     {<"+e+"> puro:instanceOf ?uri}\n                     UNION\n                     {<"+e+"> puro:subTypeOf ?uri}\n                     ?uri a ?type .\n                     ?uri rdfs:label ?label\n                 }";return new Promise((function(e){r.sparqlQuery(t,(function(t){r.recursiveFindChild(0,t,[],(function(t){e(t)}),"relation")}))}))},this.getRelations=function(){return new Promise((function(e){r.sparqlQuery("\n                PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                SELECT ?uri ?valuation ?from ?to ?toType ?fromType ?label ?type  WHERE \n                {\n                  ?uri a puro:BRelation . \n                  ?from puro:linkedTo ?uri .\n                  ?uri puro:linkedTo ?to .\n                  ?uri rdfs:label ?label . \n                  ?uri a ?type .\n                  OPTIONAL {?uri puro:linkedTo ?valuation. ?valuation a puro:BValuation}\n                  {?from a puro:BObject}\n                  UNION \n                  {?from a puro:BType}\n                  {?to a puro:BObject}\n                  UNION\n                  {?to a puro:BType} \n                  ?to a ?toType . \n                  ?from a ?fromType . \n                }",function(t){t=this.deleteDuplicity(t,["from","to","toType","fromType","valuation"]),console.log(t),e(t)}.bind(r))}))},this.findRelation=function(e){var t="\n                PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                SELECT ?uri ?label  WHERE \n                {\n                  <"+e+"> puro:linkedTo ?uri . \n                }";return new Promise((function(e){r.sparqlQuery(t,(function(t){e(t)}))}))},this.firstFind=Object(O.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"\n                PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                SELECT ?uri ?label ?child WHERE \n                {\n                    {?child puro:instanceOf ?uri}\n                     UNION\n                    {?child puro:subTypeOf ?uri}\n                    ?uri rdfs:label ?label. asfadf\n                    ?uri a puro:BType\n                    FILTER NOT EXISTS {?uri puro:linkedTo ?obj}\n                    FILTER NOT EXISTS {?uri puro:subTypeOf ?object}\n                }",e.abrupt("return",new Promise((function(e){r.sparqlQuery("\n                PREFIX puro: <http://lod2-dev.vse.cz/ontology/puro#>\n                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                SELECT ?uri ?label ?child WHERE \n                {\n                    {?child puro:instanceOf ?uri}\n                     UNION\n                    {?child puro:subTypeOf ?uri}\n                    ?uri rdfs:label ?label. asfadf\n                    ?uri a puro:BType\n                    FILTER NOT EXISTS {?uri puro:linkedTo ?obj}\n                    FILTER NOT EXISTS {?uri puro:subTypeOf ?object}\n                }",(function(t){e(t)}))})));case 2:case"end":return e.stop()}}),e)}))),this.deleteDuplicity=function(e,t){var n,r=[],o=!0,l=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var u=a.value,h=!0,c=!1,d=void 0;try{for(var p,y=t[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var f=p.value;null===u[f]?u[f]=[]:u[f]=[u[f].value]}}catch(C){c=!0,d=C}finally{try{h||null==y.return||y.return()}finally{if(c)throw d}}}}catch(C){l=!0,i=C}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}for(var v=e.length-1;v>=0;v--)if(r.includes(e[v].uri.value)){var m=!0,g=!1,T=void 0;try{for(var b,O=function(){for(var t=b.value,r=function(r){if(n=e[v][t],e[r].uri.value===e[v].uri.value){if(!n.some((function(n){return e[r][t].includes(n)})))return e[r][t]=e[r][t].concat(n),"break";if(t.includes("Type")&&e[r][t.split("Type")[0]].length!==e[r][t].length)return e[r][t]=e[r][t].concat(n),"break"}},o=e.length-1;o>=0;o--){if("break"===r(o))break}},E=t[Symbol.iterator]();!(m=(b=E.next()).done);m=!0)O()}catch(C){g=!0,T=C}finally{try{m||null==E.return||E.return()}finally{if(g)throw T}}e.splice(v,1)}else r.push(e[v].uri.value);return e},this.rdf=n(868),y.a.ajax({type:"GET",url:"puroOutput.xml",async:!1,cache:!1,dataType:"xml",success:function(e){this.puroXML=e,t=e}}),this.puroXML=t},C=function(){function e(){var t;Object(o.a)(this,e),y.a.ajax({type:"GET",url:"rules.json",async:!1,cache:!1,dataType:"json",success:function(e){t=e}}),this.rulesJson=JSON.parse(JSON.stringify(t)),this.ontoUri="http://lod2-dev.vse.cz/data/ontomodels#"}return Object(l.a)(e,[{key:"createButtons",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=(e=Array.isArray(e)?e:[e]).map((function(e){return{name:e}}));return Promise.resolve({buttons:l,title:t,type:n,elName:r,originalName:o})}},{key:"createQuestion",value:function(e,t){var n="";if("question"in e.rule){var r=!0,o=!1,l=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;if(s.type===e.rule.question){n=s.question;break}}}catch(c){o=!0,l=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}n=""===n?e.rule.question:n;var u=e.key in e.rule?e.rule[e.key][0]:e.rule.type[0];return n.replace("VAL",this.delUri(e.element)).replace("TYPE",u)}var h=this.isSameCaseInsensitive(e.key,"connect")?" to ":" of ";return"What is "+e.key+h+this.delUri(e.element)+"?"}},{key:"countBTypesInTree",value:function(e){var t=0,n=!0,r=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;"BType"!==this.delUri(a.type.value)||a.fatherTypeRelation.includes("http://lod2-dev.vse.cz/ontology/puro#instanceOf")||t++}}catch(s){r=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return t}},{key:"delUri",value:function(e){var t=[];if("string"===typeof e)return e.split("#")[1];if(Array.isArray(e)){var n=!0,r=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;t.push(a.split("#")[1])}}catch(s){r=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return t}return""}},{key:"getKeyByValue",value:function(e,t){return Object.keys(e).find((function(n){return e[n]===t}))}},{key:"isSameCaseInsensitive",value:function(e,t){return 0===e.localeCompare(t,void 0,{sensitivity:"base"})}}]),e}(),R=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(a.a)(t).call(this))).addToOntoModel=function(t,n,r,o,l,i,a,s,u,h,c){var d,p,y;!1===e.getOntoElement(e.ontoUri+a)?(s=void 0!==s&&s,c=void 0===c?"":c,""!==a&&void 0!==a&&!1===s?(d=!1,p=a,y=e.ontoUri+a):(d=o,p=s?a:n,y=t),!1===e.getOntoElement(y)&&e.ontoModel.push({uri:y,label:p,ontoType:r,puroType:d,fromRelation:[l],direction:[i],from:[void 0],to:[void 0],type:"Class",branchIndex:[h],origUri:c})):(t=u+a,e.updateOntoModel(t,"fromRelation",l),e.updateOntoModel(t,"direction",i),e.updateOntoModel(t,"branchIndex",h));return console.log(e.ontoModel),e.ontoModel},e.addRelation=function(t,n,r,o,l,i,a){o=void 0===o?e.ontoUri.slice(0,-1)+"/relation/"+t+"/"+e.delUri(n)+e.delUri(r):o,i=void 0===i?[]:[i],a=void 0===a?[]:[a],n=void 0===n||0===n.length?[]:[n],r=void 0===r||0===r.length?[]:[r];var s=!0,u=!1,h=void 0;try{for(var c,d=e.ontoModel[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;if("relation"===p.type&&p.from.includes(n)&&p.to.includes(r))return e.ontoModel}}catch(y){u=!0,h=y}finally{try{s||null==d.return||d.return()}finally{if(u)throw h}}return e.ontoModel.push({type:"relation",ontoType:t,from:n,to:r,uri:o,label:l,fromType:i,toType:a,fromRelation:[]}),e.ontoModel},e.updateOntoModel=function(t,n,r){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=!0,i=!1,a=void 0;try{for(var s,u=e.ontoModel[Symbol.iterator]();!(l=(s=u.next()).done);l=!0){var h=s.value;if(h.uri===t)return Array.isArray(h[n])?!0!==o&&h[n].includes(r)||h[n].push(r):!0!==o&&h[n]===r||(h[n]=r),e.ontoModel}}catch(c){i=!0,a=c}finally{try{l||null==u.return||u.return()}finally{if(i)throw a}}return!1},e.getOntoModel=function(){return e.ontoModel},e.getElementsRelation=function(t,n){var r=[],o=!0,l=!1,i=void 0;try{for(var a,s=e.ontoModel[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var u=a.value,h=!1;Array.isArray(u[n])&&(h=!!u[n].includes(t)),"relation"===u.type&&!0===h?r.push(u):"connect"===n&&(u.from.includes(t)||u.to.includes(t))&&r.push(u)}}catch(c){l=!0,i=c}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}return r},e.getElementOntoType=function(t){var n=e.getOntoElement(t);return!1!==n&&n.ontoType},e.getElementsByOntoType=function(t,n){var r=[],o=!0,l=!1,i=void 0;try{for(var a,s=e.ontoModel[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var u=a.value;t!==u.ontoType||void 0!==n&&!u.fromRelation.includes(n)||r.push(u.uri)}}catch(h){l=!0,i=h}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}return r},e.getOntoElement=function(t){var n=!0,r=!1,o=void 0;try{for(var l,i=e.ontoModel[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;if(a.uri===t)return a}}catch(s){r=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!1},e.changeOrigin=function(t,n){for(var r=0;r<e.ontoModel.length;r++)if(e.ontoModel[r].uri===t)return e.ontoModel[r].origin=n,!0;return!1},e.getLastElementUri=function(t,n){for(var r=e.ontoModel.length-1;r>=0;r--)for(var o=0;o<e.ontoModel[r].fromRelation.length;o++){if(e.ontoModel[r].fromRelation[o]===t&&e.ontoModel[r].direction[o]===n&&"Datatype"!==e.ontoModel[r].ontoType)return e.ontoModel[r].uri;if(e.ontoModel[r].fromRelation[o]===t&&void 0===n)return e.ontoModel[r].uri;if(void 0===t&&void 0===n)return e.ontoModel[r].uri}return!1},e.getLastElement=function(t,n){var r=e.getLastElementUri(t,n);return e.getOntoElement(r)},e.getFatherOntoType=function(t){var n=[];if("father"in t){var r=!0,o=!1,l=void 0;try{for(var i,a=e.ontoModel[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;t.father.includes(s.uri)&&n.push(s.ontoType)}}catch(u){o=!0,l=u}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}}return 0===n.length&&(n=[""]),n},e.getRelationElements=function(t,n,r,o,l,i,a,s,u,h,c){var d,p,y=e.getOntoElement(r);if(""!==t&&"dataType"!==a&&!1===h&&(!1!==n||!1!==y))return"superType"===a?(d=e.ontoUri+t,p=!1!==y?y.uri:n.uri.value):"subType"===a?(p=e.ontoUri+t,d=!1!==y?y.uri:n.uri.value):(d=!1!==n?void 0===n.father[0]?n.uri.value:n.father[0]:y.uri,p=e.ontoUri+t),[d,p];if(a.includes("elementSelection")||!1!==n&&!1!==e.getOntoElement(n.father[0])){var f=e.getOntoElement(n.father[0]);return a.includes("invert")||!a.includes("elementSelection")?[f.uri,n.uri.value]:[n.uri.value,f.uri]}if(0===l&&!0===i||!1===n){var v=e.getLastElement(o),m=!1===n?e.ontoUri+t:r;if(!1!==v&&(v.direction[v.direction.length-1]!==u||!0===c)&&0===l)return e.updateOntoModel(o,u,m,!1),o;if(!1===n||!1!==v)return[v.uri,m]}},e.checkDuplicity=function(t){var n=!0,r=!1,o=void 0;try{for(var l,i=e.ontoModel[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){if(l.value.label===t)return!1}}catch(a){r=!0,o=a}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!0},e.getRelatedTypes=function(t,n,r){var o=e.getElementsRelation(t,n),l=[],i=[],a=!0,s=!1,u=void 0;try{for(var h,c=o[Symbol.iterator]();!(a=(h=c.next()).done);a=!0){var d=h.value;if(d.ontoType===r||"Generalization"===r&&d.ontoType.includes("memberOf")){var p=d.to.includes(t)?d.from[d.to.indexOf(t)]:d.to[d.from.indexOf(t)];l.push(p),i.push(e.getElementOntoType(p))}else if(!1===r&&"Relator"===d.ontoType)i.push(d.ontoType);else if(!1===r){var y=d.to.includes(t)?d.from[d.to.indexOf(t)]:d.to[d.from.indexOf(t)];l.push(y),i.push(e.getElementOntoType(y))}}}catch(f){s=!0,u=f}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}return i},e.ontoModel=[],e}return Object(s.a)(t,e),Object(l.a)(t,[{key:"isRelationComplete",value:function(e){return"relation"===e.type&&e.from.length>0&&e.to.length>0}},{key:"getCardinalElement",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var l,i=this.ontoModel[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;if("relation"===a.type&&"generalization"===a.ontoType.toLowerCase()&&a.from[0]===e&&!1===t)return a.to[0];if("relation"===a.type&&"generalization"===a.ontoType.toLowerCase()&&a.to[0]===e&&!0===t)return a.from[0]}}catch(s){r=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!1}},{key:"getElementByProperty",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var l,i=this.ontoModel[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;if(a[e]===t)return a}}catch(s){r=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!1}},{key:"getReletadELement",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var l,i=this.ontoModel[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value;if("relation"===a.type&&(a.from.includes(e.uri)||a.to.includes(e.uri))&&this.isRelationComplete(a)){var s=void 0;if(s=a.from.includes(e.uri)?a.to[0]:a.from[0],(s=this.getOntoElement(s)).fromRelation.includes(t))return s}}}catch(u){r=!0,o=u}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!1}},{key:"addToProperty",value:function(e,t,n){var r=!0,o=!1,l=void 0;try{for(var i,a=this.ontoModel[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;if(s.uri===e&&Array.isArray(s[t]))return s[t].push(n),!0}}catch(u){o=!0,l=u}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return!1}},{key:"getElementsFromBranch",value:function(e){for(var t=[e],n=e;!1!==this.getCardinalElement(n,!0);)n=this.getCardinalElement(n,!0),t.push(n);return t}},{key:"getOntoBranch",value:function(e,t){var n=[],r=!0,o=!1,l=void 0;try{for(var i,a=this.ontoModel[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;for(var u in s.fromRelation)s.fromRelation[u]===e&&s.direction[u]===t&&n.push(s)}}catch(h){o=!0,l=h}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return n}},{key:"connectToBranchElement",value:function(e,t,n){var r="To which element is the "+this.delUri(n.uri.value)+" connected?",o=this.getOntoBranch(e,t)[0],l=this.getLastElement(e,t);return void 0!==o&&!1!==l&&this.createButtons([o.label,l.label],r,"nextBranchElements",!1,"")}},{key:"undo",value:function(e){this.ontoModel=JSON.parse(JSON.stringify(e))}}]),t}(C),x=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(a.a)(t).call(this))).createGraph=function(t){e.ontoModel=t;var n="classDiagram\n",r=!0,o=!1,l=void 0;try{for(var i,a=e.ontoModel[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;if("relation"===s.type&&!1!==e.findLabel(s.to[0])&&!1!==e.findLabel(s.from[0]))if("Relator"===s.ontoType){if(s.from.length>0&&s.to.length>0){s.fromType,s.toType;for(var u in n+="class "+s.label+"{\n                                <<"+s.ontoType+">>\n                        }\n",s.from)n+=e.findLabel(s.from[u])+" "+(s.fromType[u]?'"'+s.fromType[u][0]+'"':"")+" .. "+(s.toType[u]?'"'+s.fromType[u][1]+'"':"")+" "+s.label+" : <<Mediation>>\n";for(var h in s.to)n+=s.label+" "+(s.toType[h]?'"'+s.toType[h][0]+'"':"")+" .. "+(s.toType[h]?'"'+s.toType[h][1]+'"':"")+" "+e.findLabel(s.to[h])+" : <<Mediation>>\n"}}else{s.fromType,s.toType;var c=e.getRelationSpec(s.ontoType);if(s.from.length===s.to.length)for(var d in s.from)n+=e.findLabel(s.from[d])+" "+(s.fromType[d]?'"'+s.fromType[d]+'"':"")+c[0]+(s.toType[d]?'"'+s.toType[d]+'"':"")+" "+e.findLabel(s.to[d])+(!0===c[1]?" : <<"+s.ontoType.split("-")[0]+">>":"")+"\n";else for(var p in s.from){var y=e.findLabel(s.from[p])+" "+(s.fromType[p]?'"'+s.fromType[p]+'"':"")+c[0];for(var f in s.to)n+=y+(s.toType[f]?'"'+s.toType[f]+'"':"")+" "+e.findLabel(s.to[f])+(!0===c[1]?" : <<"+s.ontoType.split("-")[0]+">>":"")+"\n"}}else"relation"!==s.type&&(n+="class "+s.label+"{\n                    <<"+s.ontoType+">>\n                }\n")}}catch(v){o=!0,l=v}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return"classDiagram"!==n.trim()&&n},e.ontoModel=[],e}return Object(s.a)(t,e),Object(l.a)(t,[{key:"getRelationSpec",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,l=this.rulesJson.relations[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var i=o.value;if(e in i){var a=i[e],s="showType"in i&&!0===i.showType,u=void 0;switch(a.toLowerCase()){case"arrowline":u=" <|-- ";break;case"simpleline":u=" -- ";break;case"dashedline":u=" .. ";break;case"composition":u=" *-- ";break;case"aggregation":u=" o-- ";break;default:u=" -- "}return[u,s]}}}catch(h){n=!0,r=h}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}}},{key:"findLabel",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,l=this.ontoModel[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var i=o.value;if(i.uri===e)return i.label}}catch(a){n=!0,r=a}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}return!1}}]),t}(C),S=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(l)))).ruleSelection=function(e,t,r,o,l,i,a){var s,u,h,c="";if(s=l||n.getSpecificRule(e,t).offer,!1!==r){var d="";r.connect.length>1&&(d="\n In term of "+a+" relationship."),n.isElementInstace(r,i)?(h=!0,r.uri.value,u=n.rulesJson.questions[1].question.replace("VAL",r.label.value)+d):(h=!1,r.uri.value,u=n.rulesJson.questions[0].question.replace("VAL",r.label.value)+d,c=r.label.value)}else{h=!0;var p=!0,y=!1,f=void 0;try{for(var v,m=n.rulesJson.questions[Symbol.iterator]();!(p=(v=m.next()).done);p=!0){var g=v.value;if("bTypeChild"===g.type){u=g.question.replace("VAL",o);break}}}catch(T){y=!0,f=T}finally{try{p||null==m.return||m.return()}finally{if(y)throw f}}}return n.createButtons(s,u,"classSelection",h,c)},n.isElementInstace=function(e,t){var r=!0,o=!1,l=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;if(e.uri.value===s.uri.value){var u=!0,h=!1,c=void 0;try{for(var d,p=s.fatherTypeRelation[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var y=d.value;if("instanceOf"===n.delUri(y))return!0}}catch(f){h=!0,c=f}finally{try{u||null==p.return||p.return()}finally{if(h)throw c}}}}}catch(f){o=!0,l=f}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return!1},n.elementConsistencyRules=function(e,t){var r=n.rulesJson[e.ontoType],o=[],l={superType:t.getRelatedTypes(e.uri,"to","Generalization"),subType:t.getRelatedTypes(e.uri,"from","Generalization"),connect:t.getRelatedTypes(e.uri,"connect",!1)};console.log(JSON.parse(JSON.stringify(l)));var i=!0,a=!1,s=void 0;try{for(var u,h=r[Symbol.iterator]();!(i=(u=h.next()).done);i=!0){var c=u.value;o=n.elementConsistencySelection(c,l.connect,"connect",e,o,r,l),o=n.elementConsistencySelection(c,l.superType,"superType",e,o,r,l),o=n.elementConsistencySelection(c,l.subType,"subType",e,o,r,l)}}catch(d){a=!0,s=d}finally{try{i||null==h.return||h.return()}finally{if(a)throw s}}return console.log(JSON.parse(JSON.stringify(o))),console.log(o.length),o.length>0&&o[0].types.includes("Relator")&&o[0].types.includes("None")&&o.splice(0,1),o},n.elementConsistencySelection=function(e,t,r,o,l,i,a){if(e.key===r){var s="e"===r[r.length-1]?"d":"ed",u=n.getSpecificRule(i,r+s,!0);if(!e.type.some((function(e){return t.includes(e)}))&&e.type.length>0)l.push({key:r,types:e.type,element:o.uri,rule:e});else if(!1!==u){var h=!0,c=!1,d=void 0;try{for(var p,y=u[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var f=p.value;f.type.some((function(e){return t.includes(e)}))&&(l=n.elementConsAddSelection("superType",f,t,l,o,a),l=n.elementConsAddSelection("subType",f,t,l,o,a),l=n.elementConsAddSelection("connect",f,t,l,o,a))}}catch(v){c=!0,d=v}finally{try{h||null==y.return||y.return()}finally{if(c)throw d}}}}return l},n.getSpecificRule=function(e,t,n,r){var o=[];if(n=void 0!==n&&n,!1!==(r=void 0!==r&&r)){var l=!0,i=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(l=(s=u.next()).done);l=!0){var h=s.value;if(h.key===t&&"bTypeNumber"in h&&h.bTypeNumber.includes(r)){if(!0!==n)return h;o.push(h)}}}catch(m){i=!0,a=m}finally{try{l||null==u.return||u.return()}finally{if(i)throw a}}}var c=!0,d=!1,p=void 0;try{for(var y,f=e[Symbol.iterator]();!(c=(y=f.next()).done);c=!0){var v=y.value;if(v.key===t){if(!0!==n)return v;o.push(v)}}}catch(m){d=!0,p=m}finally{try{c||null==f.return||f.return()}finally{if(d)throw p}}return o.length>0&&e},n.getAdditionalRule=function(e,t,n){return!1!==e&&n.toString()in e&&t in e[n]?(console.log(e[n][t]),e[n][t]):[]},n.commonRuleSelection=function(e,t,r){var o=[],l=[],i=e.connect.length>0,a=!0,s=!1,u=void 0;try{for(var h,c=e.childType[Symbol.iterator]();!(a=(h=c.next()).done);a=!0){var d=h.value;l.push(n.delUri(d))}}catch(S){s=!0,u=S}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}var p=!0,y=!1,f=void 0;try{for(var v,m=r[Symbol.iterator]();!(p=(v=m.next()).done);p=!0){var g=v.value;e.father.includes(g.uri)&&o.push(g.ontoType)}}catch(S){y=!0,f=S}finally{try{p||null==m.return||m.return()}finally{if(y)throw f}}var T=!0,b=!1,O=void 0;try{for(var E,C=function(){var t=E.value;if((o.some((function(e){return t.fatherOnto.includes(e)}))||t.fatherOnto.includes("none"))&&(i===t.connection||0===t.connection)&&e.childType.some((function(e){return t.childPuro.includes(e)||t.childPuro.includes("none")}))){var r="elementSelection";"invert"in t&&!0===t.invert&&(r+="-invert");var l="Which type is "+e.label.value+"?";return{v:n.createButtons(t.offer,l,r,!1,e.label.value)}}},R=n.rulesJson.commonRules[Symbol.iterator]();!(T=(E=R.next()).done);T=!0){var x=C();if("object"===typeof x)return x.v}}catch(S){b=!0,O=S}finally{try{T||null==R.return||R.return()}finally{if(b)throw O}}},n}return Object(s.a)(t,e),Object(l.a)(t,[{key:"elementConsAddSelection",value:function(e,t,n,r,o,l){if(e in t&&!t[e].some((function(t){return l[e].includes(t)}))&&t[e].length>0){for(var i in r)r[i].key===e&&r[i].element===o.uri&&r.splice(i,1);r.push({key:e,types:t[e],element:o.uri,rule:t})}return r}},{key:"numberOfRuleStep",value:function(e,t,n){var r=this.getSpecificRule(this.rulesJson[e],t,!1,n),o=0;for(var l in r)isNaN(l)||o++;return o}}]),t}(C),k=function(){function e(){Object(o.a)(this,e),this.ontoModelHistory=[],this.propertiesHistory=[],this.inputVariables=[]}return Object(l.a)(e,[{key:"init",value:function(e){this.propertiesHistory.push(e),this.ontoModelHistory.push([])}},{key:"reset",value:function(){this.ontoModelHistory=[],this.propertiesHistory=[],this.inputVariables=[]}},{key:"saveRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;this.propertiesHistory.push(e),this.ontoModelHistory.push(t),this.inputVariables.push(n)}},{key:"undo",value:function(){this.ontoModelHistory.pop();var e=this.propertiesHistory.pop();return this.inputVariables.pop(),void 0!==this.propertiesHistory[this.propertiesHistory.length-2]&&0===this.propertiesHistory[this.propertiesHistory.length-2].queryTree.length&&(this.propertiesHistory[this.propertiesHistory.length-2].queryTree=JSON.parse(JSON.stringify(e.queryTree))),console.log(this.propertiesHistory),console.log(this.inputVariables),console.log(this.ontoModelHistory),{ontoModel:this.ontoModelHistory[this.ontoModelHistory.length-2],properties:this.propertiesHistory[this.propertiesHistory.length-2],inputVariables:this.inputVariables[this.inputVariables.length-1]}}}]),e}(),N=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"transform",value:function(e){var t=this.schemaInit(),r=0,o=!0,l=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var u=a.value;"Class"!==u.type&&"relator"!==u.ontoType.toLowerCase()||t.contents.push(this.ontoClassTransformation(u))}}catch(N){l=!0,i=N}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}console.log(t);var h=!0,c=!1,d=void 0;try{for(var p,y=e[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var f=p.value;if("relation"===f.type&&"relator"!==f.ontoType.toLowerCase()){var v=void 0;v=f.from.length>=f.to.length?"from":"to";var m=0;for(var g in f[v]){var T="from"===v?g:m,b="to"===v?g:m;t.contents.push(this.relationTransformation(f,r,T,b)),r+=2,g<=f[v].length&&(m=g)}}else if("relator"===f.ontoType.toLowerCase()){var O=JSON.parse(JSON.stringify(f)),E=JSON.parse(JSON.stringify(f)),C=void 0;C=f.from.length>=f.to.length?"from":"to";var R=0;for(var x in f[C])O.uri+="rel1",E.uri+="rel2",O.ontoType+="mediation",E.ontoType+="mediation","from"===C?(O.fromType=f.fromType[x][0],O.toType=f.fromType[x][1],E.fromType=f.toType[R][0],E.toType=f.toType[R][1],O.from=[O.from[x]],E.to=[O.to[R]]):(O.fromType=f.fromType[R][0],O.toType=f.fromType[R][1],E.fromType=f.toType[x][0],E.toType=f.toType[x][1],O.from=[O.from[R]],E.to=[O.to[x]]),O.to=[f.uri],E.from=[f.uri],t.contents.push(this.relationTransformation(O,r,0,0)),r+=2,t.contents.push(this.relationTransformation(E,r,0,0)),r+=2,x<=f[C].length&&(R=x)}}}catch(N){c=!0,d=N}finally{try{h||null==y.return||y.return()}finally{if(c)throw d}}var S=n(831),k=(new(n(833))).compile(S.getSchema(S.ONTOUML_2));if(this.ontoModel=this.initJson(),k(t))return t;alert("Model is not valid! Check OntoSchemaCotroller!")}},{key:"schemaInit",value:function(){return{type:"Package",id:"puroConversion",name:null,description:null,contents:[],propertyAssignments:null}}},{key:"ontoClassTransformation",value:function(e){return{type:"Class",id:e.uri,name:e.label,description:null,properties:null,literals:null,propertyAssignments:null,stereotypes:[e.ontoType.toLowerCase()],isAbstract:null,isDerived:null}}},{key:"relationTransformation",value:function(e,t,n,r){return"Generalization"===e.ontoType?{type:"Generalization",id:e.uri,name:null,description:null,general:{type:"Class",id:e.from[n]},specific:{type:"Class",id:e.to[r]},propertyAssignments:{nonStandardProperty:null}}:{type:"Relation",id:e.uri,name:null,description:null,properties:[{type:"Property",id:"prop"+t,name:null,description:null,propertyType:{type:"Class",id:e.from[n]},cardinality:""===e.fromType[n]?null:e.fromType[n],isDerived:null,isOrdered:null,isReadOnly:null,stereotypes:null,propertyAssignments:null,subsettedProperties:null,redefinedProperties:null,aggregationKind:null},{type:"Property",id:"prop"+(parseInt(t)+1),name:null,description:null,propertyType:{type:"Class",id:e.to[r]},cardinality:""===e.toType[r]?null:e.toType[r],isDerived:null,isOrdered:null,isReadOnly:null,stereotypes:null,propertyAssignments:null,subsettedProperties:null,redefinedProperties:null,aggregationKind:null}],propertyAssignments:{nonStandardProperty:null},stereotypes:[e.ontoType.toLowerCase()],isAbstract:!0,isDerived:!1}}},{key:"initJson",value:function(){return JSON.parse('[\n        {\n          "type": "relation",\n          "ontoType": "Characterization",\n          "from": [\n            "http://lod2-dev.vse.cz/data/puromodels#Book"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/puromodels#Topic"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#has_topic",\n          "label": "has_topic",\n          "fromType": [\n            "1"\n          ],\n          "toType": [\n            "1"\n          ],\n          "fromRelation": []\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#Book",\n          "label": "Book",\n          "ontoType": "Kind",\n          "puroType": "BType",\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#has_topic",\n            "http://lod2-dev.vse.cz/data/puromodels#published_in"\n          ],\n          "direction": [\n            "from",\n            "from"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#Topic",\n          "label": "Topic",\n          "ontoType": "Mode",\n          "puroType": "BType",\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#has_topic"\n          ],\n          "direction": [\n            "to"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        },\n        {\n          "type": "relation",\n          "ontoType": "Generalization",\n          "from": [\n            "http://lod2-dev.vse.cz/data/puromodels#Topic"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/puromodels#DDC_Topic"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels/relation/Generalization/TopicDDC_Topic",\n          "label": "nazev",\n          "fromType": [\n            ""\n          ],\n          "toType": [\n            ""\n          ],\n          "fromRelation": []\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#DDC_Topic",\n          "label": "DDC_Topic",\n          "ontoType": "Subkind",\n          "puroType": "BType",\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#has_topic"\n          ],\n          "direction": [\n            "to"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        },\n        {\n          "type": "relation",\n          "ontoType": "Relator",\n          "from": [\n            "http://lod2-dev.vse.cz/data/ontomodels#q"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/puromodels#Location"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#published_in",\n          "label": "published_in",\n          "fromType": [\n            [\n              "1",\n              "1"\n            ]\n          ],\n          "toType": [\n            [\n              "1",\n              "1"\n            ]\n          ],\n          "fromRelation": []\n        },\n        {\n          "type": "relation",\n          "ontoType": "Generalization",\n          "from": [\n            "http://lod2-dev.vse.cz/data/puromodels#Book"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/ontomodels#q"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels/relation/Generalization/Bookq",\n          "label": "nazev",\n          "fromType": [\n            ""\n          ],\n          "toType": [\n            ""\n          ],\n          "fromRelation": []\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels#q",\n          "label": "q",\n          "ontoType": "Role",\n          "puroType": false,\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#published_in"\n          ],\n          "direction": [\n            "from"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels#w",\n          "label": "w",\n          "ontoType": "Datatype",\n          "puroType": "BValue",\n          "fromRelation": [\n            {\n              "token": "uri",\n              "value": "http://lod2-dev.vse.cz/data/puromodels#published_in"\n            }\n          ],\n          "direction": [\n            "from"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            null\n          ]\n        },\n        {\n          "type": "relation",\n          "ontoType": "connect",\n          "from": [\n            "http://lod2-dev.vse.cz/data/puromodels#published_in"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/ontomodels#w"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels/relation/connect/published_inw",\n          "label": "nazev",\n          "fromType": [\n            "*"\n          ],\n          "toType": [\n            "*"\n          ],\n          "fromRelation": []\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/puromodels#Location",\n          "label": "Location",\n          "ontoType": "Role",\n          "puroType": "BType",\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#published_in"\n          ],\n          "direction": [\n            "to"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        },\n        {\n          "type": "relation",\n          "ontoType": "Generalization",\n          "from": [\n            "http://lod2-dev.vse.cz/data/ontomodels#e"\n          ],\n          "to": [\n            "http://lod2-dev.vse.cz/data/puromodels#Location"\n          ],\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels/relation/Generalization/eLocation",\n          "label": "nazev",\n          "fromType": [\n            ""\n          ],\n          "toType": [\n            ""\n          ],\n          "fromRelation": []\n        },\n        {\n          "uri": "http://lod2-dev.vse.cz/data/ontomodels#e",\n          "label": "e",\n          "ontoType": "Kind",\n          "puroType": false,\n          "fromRelation": [\n            "http://lod2-dev.vse.cz/data/puromodels#published_in"\n          ],\n          "direction": [\n            "to"\n          ],\n          "from": [\n            null\n          ],\n          "to": [\n            null\n          ],\n          "type": "Class",\n          "branchIndex": [\n            1\n          ]\n        }\n      ]')}}]),e}(),w=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(a.a)(t).call(this))).rdfController=new E,e.ontoController=new R,e.imageController=new x,e.ruleController=new S,e.historyController=new k,e.ontoSchemaController=new N,e.rdfController.getFullPath().then((function(t){e.queryTree=t,console.log(t)})),e.rdfController.getRelations().then((function(t){e.relations=t})),e.elSettings={},e.relationOrderIndex=0,e.relation={},e.relationIndex=0,e.relationType="",e.setIndexexToDefault(),e}return Object(s.a)(t,e),Object(l.a)(t,[{key:"getDefault",value:function(){if(this.relationOrderIndex===this.relations.length)return alert("Transformation is comlete!!!"),{buttons:[],title:"The End",type:"end"};var e=this.relations[this.relationOrderIndex];if(this.relation=e,this.ruleKey="from",this.relation.valuation.length>0){var t=e.label.value.charAt(0).toUpperCase()+e.label.value.slice(1)+" was typed as a Relator.";return this.createButtons("Relator",t,this.delUri(e.type.value),!1,e.label.value)}this.elementUri=e.uri.value;var n=this.rulesJson.bRelationRules[0].question.replace("VAL",e.label.value);return this.createButtons(this.rulesJson.bRelationRules[0].offer,n,this.delUri(e.type.value),!1,e.label.value)}},{key:"nextElement",value:function(){var e=Object(O.a)(b.a.mark((function e(t,n,r,o,l){var i,a,s,u,h,c,d,p,y,f,v,m,g,T,O,E,C,R;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log([t,n,r,o,l]),""!==o&&!0===l&&this.changeElementsProperty(this.elementUri,"label",o),"BRelation"!==r){e.next=6;break}return e.abrupt("return",this.relationWasSelected(t,this.ruleKey));case 6:if(a=[],s=r,!r.includes("ontoRelation-save-bRelation")){e.next=26;break}if(r.includes("relator")?"from"===r.replace("ontoRelation-save-bRelation-relator-","")?(this.ontoController.updateOntoModel(this.relation.uri.value,"fromType",t),s="last"===this.additionalRule.key?"updated":s):(this.ontoController.updateOntoModel(this.relation.uri.value,"toType",t),s="last"===this.additionalRule.key?"updated":s):(this.ontoController.updateOntoModel(this.relation.uri.value,"fromType",t[0]),this.ontoController.updateOntoModel(this.relation.uri.value,"toType",t[1]),s="last"===this.additionalRule.key?"updated":s),"cPhase-next"!==this.lastElInBranch){e.next=20;break}if(!(this.relation[this.ruleKey].length<=this.relationRuleIndex)){e.next=17;break}return this.relationOrderIndex++,this.setIndexexToDefault(),e.abrupt("return",this.getDefault());case 17:return e.abrupt("return",this.nextTreeBranch());case 18:e.next=26;break;case 20:t=this.elSettings.selectedType,r=this.elSettings.puroType,o=this.elSettings.elName,i=this.elSettings.relationEl,a=this.elSettings.additionalRule,l=this.elSettings.nameWasChange;case 26:if(Array.isArray(t)||"none"!==t.toLowerCase()){e.next=36;break}if(this.elSettings.selectedType=t,h=this.ontoController.getOntoElement(this.relation.uri.value),this.additionalRule.key="stop",h[this.ruleKey].length!==this.relationRuleIndex&&(c=this.ontoController.getLastElementUri(this.relation.uri.value,this.ruleKey),this.ontoController.updateOntoModel(h.uri,this.ruleKey,c)),!1===(d=this.updateRelationTypes())){e.next=34;break}return e.abrupt("return",d);case 34:return this.consistencyExeption.push({uri:this.elementUri,ontoType:t,type:r}),e.abrupt("return",this.consistencyCheck());case 36:if(r.includes("ontoRelation")||"dataType"===r){e.next=47;break}if("stop"!==this.additionalRule.key&&void 0===this.additionalRule.key&&(this.additionalRule.index>1||0===this.ontoController.getOntoBranch(this.relation.uri.value,this.ruleKey).length)?(a=this.ruleController.getAdditionalRule(this.ruleController.getSpecificRule(this.rulesJson[this.relationType],this.ruleKey,!1,this.countBTypesInTree(this.relationTree)),t,1)).length>0&&(this.additionalRule.index=2,this.additionalRule.rule=this.ruleController.getSpecificRule(this.rulesJson[this.relationType],this.ruleKey,!1,this.countBTypesInTree(this.relationTree)),this.additionalRule.key=t):this.additionalRule.index>1&&"stop"!==this.additionalRule.key&&((a=this.ruleController.getAdditionalRule(this.additionalRule.rule,t,this.additionalRule.index)).length>0?this.additionalRule.index++:this.additionalRule.key="last"),i=this.ontoController.getRelationElements(o,this.getElementByUri(this.elementUri),this.elementUri,this.relation.uri.value,a.length,0===a.length,r,this.ontoUri,this.ruleKey,l,this.relationRuleIndex>1),this.elSettings={selectedType:t,nameWasChange:l,puroType:r,ruleKey:this.ruleKey,elName:o,relationEl:i,additionalRule:a,relType:"",elUri:this.elementUri},i!==this.relation.uri.value&&"cPhase"!==this.lastElInBranch){e.next=45;break}if(!1===(p=this.updateRelationTypes())){e.next=45;break}return this.lastElInBranch+="-next",e.abrupt("return",p);case 45:e.next=48;break;case 47:"dataType"===r?(i=[t,this.ontoUri+o],this.elSettings.relationEl=i,this.elSettings.relType="connect",this.ontoController.addToOntoModel(this.ontoUri+o,o,"Datatype","BValue",this.relation.uri,this.ruleKey,void 0,void 0,void 0,void 0,this.elementUri)):(r.includes("ontoRelation-cardinality")?this.elSettings.relType=t:r.includes("ontoRelation-save")&&(u=t),t=this.elSettings.selectedType,r=this.elSettings.puroType,o=this.elSettings.elName,i=this.elSettings.relationEl,a=this.elSettings.additionalRule,l=this.elSettings.nameWasChange,this.elementUri=this.elSettings.elUri);case 48:if(!0===(y=this.getRelationRules(i,s,n,this.ruleKey,this.elSettings.selectedType,this.elSettings.relType,u))){e.next=51;break}return e.abrupt("return",Promise.resolve(y));case 51:if(null===this.valuationArr){e.next=66;break}if(!(this.valuationArr.length>0)){e.next=56;break}return e.abrupt("return",this.handleValuation());case 56:if(0!==this.valuationArr.length){e.next=66;break}if("to"!==this.ruleKey||this.relation.to.length!==this.relationRuleIndex){e.next=65;break}return f=this.ontoController.getLastElementUri(this.relation.uri.value,this.ruleKey),this.ontoController.updateOntoModel(this.relation.uri.value,"to",f),this.elementUri=f,this.lastElInBranch="cPhase",e.abrupt("return",this.updateRelationTypes());case 65:return e.abrupt("return",this.nextTreeBranch());case 66:if(v=!1!==this.selectedEl&&"type"in this.selectedEl&&this.delUri(this.selectedEl.type.value),m=void 0,this.relationTree[this.relationTree.length-1].uri.value===this.elementUri&&(m="first"),this.ontoController.addToOntoModel(this.elementUri,this.delUri(this.elementUri),t,v,this.relation.uri.value,this.ruleKey,o,l,this.ontoUri,this.relationRuleIndex,m),!(a.length>0)){e.next=77;break}return this.selectedEl=this.getNextElement(),this.elementUri=!1===this.selectedEl||Array.isArray(this.selectedEl)?"":this.selectedEl.uri.value,this.selectedEl=""!==this.elementUri&&this.selectedEl,e.abrupt("return",this.ruleController.ruleSelection(void 0,this.ruleKey,this.selectedEl,this.ontoController.getLastElement(this.relation.uri.value,this.ruleKey).label,a,this.queryTree,this.relation.label.value));case 77:if("last"!==this.additionalRule.key){e.next=89;break}if((g=this.ontoController.getOntoElement(this.relation.uri.value))[this.ruleKey].length!==this.relationRuleIndex&&(T=this.ontoController.getLastElementUri(this.relation.uri.value,this.ruleKey),this.ontoController.updateOntoModel(g.uri,this.ruleKey,T)),!1===(O=this.updateRelationTypes())){e.next=85;break}return e.abrupt("return",O);case 85:return this.additionalRule.key="stop",e.abrupt("return",this.consistencyCheck());case 87:e.next=106;break;case 89:if(this.additionalRule.key="stop",0===this.elementsWithoutType.length&&(this.elementsWithoutType=this.checkElementsInRelationTree(this.relationTree,this.ontoController.getOntoModel())),!(this.elementsWithoutType.length>0&&this.withoutTypeIndex<this.elementsWithoutType.length)){e.next=104;break}if(E=this.getElementByUri(this.elementsWithoutType[this.withoutTypeIndex].uri.value),this.withoutTypeIndex++,this.elementUri=E.uri.value,void 0!==(C=this.ruleController.commonRuleSelection(E,this.ruleKey,this.ontoController.getOntoModel()))){e.next=101;break}alert("Common rule is not defined! Check rules.json"),window.location.reload(),e.next=102;break;case 101:return e.abrupt("return",C);case 102:e.next=106;break;case 104:return 0===this.ontoController.getOntoElement(this.relation.uri.value).from.length&&(R=this.ontoController.getLastElementUri(this.relation.uri.value,this.ruleKey),this.ontoController.updateOntoModel(this.relation.uri.value,this.ruleKey,R)),e.abrupt("return",this.consistencyCheck());case 106:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,l){return e.apply(this,arguments)}}()},{key:"consistencyCheck",value:function(){var e=this.checkElementsConsistency(this.relation.uri.value,this.ruleKey);if(e.length>0){var t=!0,n=!1,r=void 0;try{for(var o,l=this.consistencyExeption[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var i=o.value;for(var a in e)i.uri===e[a].element&&e[a].types.includes(i.ontoType)&&i.type===e[a].key&&e.splice(a,1)}}catch(c){n=!0,r=c}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}(e.length>0&&e[0].types.includes("Relator")&&e[0].types.includes("None")||e.length>0&&e[0].types.includes("None")&&1===e[0].types.length)&&e.splice(0,1)}if(e.length>0){var s=this.createQuestion(e[0],this.rulesJson.questions);return this.elementUri=e[0].element,this.createButtons(e[0].types,s,e[0].key,!0)}if(null===this.valuationArr&&1===this.relationRuleIndex&&(this.valuationArr=this.getAllTreeValuations(this.ruleKey),this.valuationArr.length>0))return this.handleValuation();if(this.relation[this.ruleKey].length===this.relationRuleIndex&&"from"!==this.ruleKey){var u=this.ontoController.getOntoElement(this.relation.uri.value);if(u.to.length<this.relationRuleIndex){var h=this.ontoController.getLastElement(u.uri,"to");return this.ontoController.updateOntoModel(u.uri,"to",h.uri),this.lastElInBranch="cPhase",this.updateRelationTypes(!0)}return this.setIndexexToDefault(),this.relationOrderIndex++,this.getDefault()}return this.nextTreeBranch()}},{key:"updateRelationTypes",value:function(e){var t=this.ontoController.getOntoElement(this.relation.uri.value);if(console.log(t),t.to.length>0&&t.from.length>0){if(console.log(t),"Relator"===t.ontoType&&t.fromType.length<t.from.length){var n=this.ruleController.getSpecificRule(this.rulesJson[t.ontoType],"cardinality");return this.createRelCardinalityBtn("ontoRelation-save-bRelation-relator-from",n,"from",t.from[t.fromType.length],t.uri)}if("Relator"===t.ontoType&&t.toType.length<t.to.length){var r=this.ruleController.getSpecificRule(this.rulesJson[t.ontoType],"cardinality");return this.createRelCardinalityBtn("ontoRelation-save-bRelation-relator-to",r,"to",t.uri,t.to[t.toType.length])}if(t.toType.length<t.to.length&&t.fromType.length<t.from.length){var o=this.ruleController.getSpecificRule(this.rulesJson[t.ontoType],"cardinality");return this.createRelCardinalityBtn("ontoRelation-save-bRelation",o,"to",t.from[t.fromType.length],t.to[t.toType.length])}}return!1}},{key:"handleValuation",value:function(){var e="Which Datatype represents "+this.delUri(this.valuationArr[0].valuation)+"?",t=this.createButtons(this.valuationArr[0].el,e,"dataType",!0);return this.elementUri=this.valuationArr[0].valuation,this.valuationArr.shift(),t}},{key:"nextTreeBranch",value:function(){var e,t=this;if(null===this.valuationArr&&1===this.relationRuleIndex&&(this.valuationArr=this.getAllTreeValuations(this.ruleKey),this.valuationArr.length>0))return this.handleValuation();if(0===this.ontoController.getOntoElement(this.relation.uri.value).from.length||this.relationRuleIndex>1&&"from"===this.ruleKey){var n=this.ontoController.getLastElementUri(this.relation.uri.value,this.ruleKey);this.ontoController.updateOntoModel(this.relation.uri.value,this.ruleKey,n)}return this.relationTreeIndex===this.relationTreeArr.length?(this.relation[this.ruleKey].length===this.relationRuleIndex&&(this.ruleKey="from"===this.ruleKey?"to":"from",this.relationRuleIndex=0),e=this.getRelatedElements(this.relation,this.ruleKey),this.relationRuleIndex++):e=Promise.resolve(this.relationTreeArr),this.additionalRule.key=void 0,this.additionalRule.index=0,this.consistencyExeption=[],new Promise((function(n){e.then((function(e){t.valuationArr=null,n(t.handleRelatedElements(e,"nextElement",t.ruleKey))}))}))}},{key:"getAllTreeValuations",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var l,i=this.relationTree[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var a=l.value,s=this.getElementByUri(a.uri.value);if(s.valuation.length>0){var u=s.uri.value;if("BObject"===this.delUri(s.type.value)||s.fatherTypeRelation.includes("http://lod2-dev.vse.cz/ontology/puro#instanceOf")){var h=this.rulesJson.lastTypes,c=[],d=!0,p=!1,y=void 0;try{for(var f,v=h[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var m=f.value;c=c.concat(this.ontoController.getElementsByOntoType(m,this.relation.uri.value))}}catch(U){p=!0,y=U}finally{try{d||null==v.return||v.return()}finally{if(p)throw y}}c.length>0&&(u=c[0])}var g=!0,T=!1,b=void 0;try{for(var O,E=s.valuation[Symbol.iterator]();!(g=(O=E.next()).done);g=!0){var C=O.value;t.push({el:u,valuation:C})}}catch(U){T=!0,b=U}finally{try{g||null==E.return||E.return()}finally{if(T)throw b}}}}}catch(U){r=!0,o=U}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}if("from"===e){var R=!0,x=!1,S=void 0;try{for(var k,N=this.relation.valuation[Symbol.iterator]();!(R=(k=N.next()).done);R=!0){var w=k.value;t.push({el:this.relation.uri.value,valuation:w})}}catch(U){x=!0,S=U}finally{try{R||null==N.return||N.return()}finally{if(x)throw S}}}for(var I in t)!1!==this.ontoController.getElementByProperty("origUri",t[I].valuation)&&t.splice(I,1);return t}},{key:"getGraphSvg",value:function(){var e=this.ontoController.getOntoModel();return this.imageController.createGraph(e)}},{key:"createRelCardinalityBtn",value:function(e,t,n,r,o,l,i){e+="dataType"===l?"-daType":"";var a=t.fromT.map((function(e){return{name:e,uri:i,origin:n,direction:"from"}})),s=t.toT.map((function(e){return{name:e,uri:i,origin:n,direction:"to"}})),u=!1===this.ontoController.getOntoElement(r)?this.delUri(r):this.ontoController.getOntoElement(r).label,h=!1===this.ontoController.getOntoElement(o)?this.delUri(o):this.ontoController.getOntoElement(o).label;return{buttons:s.concat(a),title:"Select cardinality between elements",type:e,elName:[u,h]}}},{key:"getRelationRules",value:function(e,t,n,r,o,l,i){var a,s,u,h,c,d=t.replace("ontoRelation-",""),p=this.rulesJson.relationRules;if(!Array.isArray(e))return!0;if(a=e[0],s=e[1],u=!1===(u=this.ontoController.getElementOntoType(a))?o:u,h=!1===(h=this.ontoController.getElementOntoType(s))?o:h,c=this.findRule(p,["from",u,"to",h]),"updated"===t)return!0;if(!1!==c||d.includes("save")||alert("Relation rule is not defined! Check rules.json!"),d.includes("save")||"cardinality"!==d&&"dataType"!==d&&1!==c.offer.length){if(d.includes("save"))return this.ontoController.addRelation(this.elSettings.relType,a,s,void 0,"nazev",i[0],i[1]),!0;var y=c.offer.map((function(e){return{name:e,uri:n,origin:r}}));return this.elementUri=n,{buttons:y,title:"Which type of relation is between "+this.delUri(a)+" and "+this.delUri(s)+"?",type:"ontoRelation-cardinality"}}return"fromT"in c&&"toT"in c?(this.elSettings.relType=1===c.offer.length?c.offer[0]:this.elSettings.relType,this.createRelCardinalityBtn("ontoRelation-save",c,r,a,s,d,n)):(l=1===c.offer.length?c.offer[0]:l,this.ontoController.addRelation(l,a,s,void 0,"nazev","",""),!0)}},{key:"findRule",value:function(e,t){var n=!1,r=!0,o=!1,l=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;n=!1;for(var u=0;u<t.length;u+=2){var h=!0,c=!1,d=void 0;try{for(var p,y=s[t[u]][Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var f=p.value;if(this.isSameCaseInsensitive(t[u+1],f)||"*"===f){if(!0===n)return s;n=!0;break}}}catch(v){c=!0,d=v}finally{try{h||null==y.return||y.return()}finally{if(c)throw d}}}}}catch(v){o=!0,l=v}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return!1}},{key:"relationWasSelected",value:function(e){var t=this;this.ruleKey="from",this.relation=this.relations[this.relationOrderIndex],this.relationType=e;var n,r=this.rulesJson[e];return n=this.relationTreeArr.length===this.relationTreeIndex?this.getRelatedElements(this.relation,this.ruleKey):Promise.resolve(this.relationTreeArr),this.relationRuleIndex++,this.ontoController.addRelation(e,"","",this.relation.uri.value,this.relation.label.value),new Promise((function(e){n.then((function(n){e(t.handleRelatedElements(n,"relationWasSelected",t.ruleKey,r))}))}))}},{key:"handleRelatedElements",value:function(e,t,n,r){if(r=void 0===r?this.rulesJson[this.relationType]:r,this.relationTreeArr=e,this.relationTree=e[this.relationTreeIndex],this.relationTreeIndex++,this.relationIndex=this.relationTree.length-1,"relationWasSelected"===t||!1!==this.ontoController.getOntoElement(this.relationTree[this.relationIndex].uri.value)){var o,l=this.getNextElement(),i=[],a="",s=!1,u=!1,h=!1,c=null;if(Array.isArray(l)&&!1===l[1]){h=l[0],a=l[0].ontoType;var d=this.getElementByUri(l[0].uri);!1!==d&&d.child.length>0&&(s=this.getElementByUri(d.child[0]),this.selectedEl=s,u=!0),this.ontoController.updateOntoModel(l[0].uri,"branchIndex",this.relationRuleIndex,!1),(this.relationRuleIndex>1||h.fromRelation.length>0)&&!this.additionalRule.index>0&&this.additionalRule.index++}else this.selectedEl=l,(s=this.getElementByUri(this.selectedEl.uri.value)).father.length>0&&(a=this.ontoController.getElementOntoType(s.father[0]));if(""!==a&&!1!==a){var p=this.ontoController.getElementsFromBranch(h.uri),y=1,f=[];for(var v in console.log(JSON.parse(JSON.stringify(p))),p){if("first"===this.ontoController.getOntoElement(p[v]).origUri){p.length=parseInt(v)+parseInt(1);break}}console.log(p);for(var m=p.length-1;m>=0;m--){var g=this.ontoController.getOntoElement(p[m]);if(!((i=this.ruleController.getAdditionalRule(this.ruleController.getSpecificRule(this.rulesJson[this.relationType],this.ruleKey,!1,this.countBTypesInTree(this.relationTree)),g.ontoType,y)).length>0)){if(f.includes(g.ontoType)){i=[];break}c=g,this.additionalRule.key=a,i=f;break}f=i,this.additionalRule.index++,y=this.additionalRule.index,m===p.length-1&&(this.additionalRule.key=a,i=f)}i.length>0&&(this.additionalRule.rule=this.ruleController.getSpecificRule(r,n,this.countBTypesInTree(this.relationTree)))}return 0===i.length?!1===s&&!0===u?this.nextTreeBranch():"relationWasSelected"!==t&&!0===u?(this.ontoController.updateOntoModel(this.relation.uri.value,n,h.uri),this.elementUri=h.uri,this.lastElInBranch="cPhase",this.updateRelationTypes(!0)):"relationWasSelected"!==t||!0!==u&&!1===h?(this.elementUri=this.selectedEl.uri.value,this.ruleController.ruleSelection(r,n,s,this.ontoController.getLastElement(this.relation.uri.value,this.ruleKey).label,void 0,this.queryTree,this.relation.label.value)):(this.ontoController.updateOntoModel(this.relation.uri.value,n,h.uri),this.nextTreeBranch()):(this.elementUri=!1!==s?this.selectedEl.uri.value:"",null!==c?(this.elementUri=c.uri,o=c.label):o=this.ontoController.getLastElement(this.relation.uri.value,this.ruleKey).label,this.ruleController.ruleSelection(void 0,n,s,o,i,this.queryTree,this.relation.label.value))}var T=this.rulesJson[this.relationType];return this.selectedEl=this.relationTree[this.relationIndex],this.relationIndex--,this.elementUri=this.selectedEl.uri.value,this.ruleController.ruleSelection(T,n,this.selectedEl,this.ontoController.getLastElement(this.relation.uri.value,this.ruleKey).label,void 0,this.queryTree,this.relation.label.value)}},{key:"checkElementsInRelationTree",value:function(e,t){var n=[],r=!0,o=!0,l=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var u=a.value;r=!0;var h=!0,c=!1,d=void 0;try{for(var p,y=t[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var f=p.value;u.uri.value===f.uri&&(r=!1)}}catch(v){c=!0,d=v}finally{try{h||null==y.return||y.return()}finally{if(c)throw d}}!0!==r||this.isElementUseless(u)||this.isElementInstace(u)||n.push(u)}}catch(v){l=!0,i=v}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}return n}},{key:"getRelatedElements",value:function(e,t){var n=this;this.elementConsitencyTree=[],this.elementConsistencyIndex=0,this.relationTreeIndex=0,this.relationTreeArr=[];var r=[];return r.push(this.rdfController.getRelationBTypes(e[t][this.relationRuleIndex])),Promise.all(r).then((function(r){console.log(r);for(var o=0;o<r.length;o++)r[o].length>0?(r[o].unshift(n.getElementByUri(e[t][n.relationRuleIndex-1])),r[o]=r[o].map((function(e){return n.getElementByUri(e.uri.value)}))):r[o]=[n.getElementByUri(e[t][o])];return r}))}},{key:"l",value:function(e){console.log("CECKKKKKKKKKKKKKKKKKKKKK"),console.log(e)}},{key:"getNextElement",value:function(){if(this.relationIndex<0)return!1;var e,t=this.ontoController.getOntoModel();this.isElementUseless(this.relationTree[this.relationIndex])&&this.relationIndex--;this.relationIndex;for(var n=0;n<t.length;n++)if(void 0!==this.relationTree[this.relationIndex]&&t[n].uri===this.relationTree[this.relationIndex].uri.value){if(this.areChildrenInBranchUseless(this.relationTree[this.relationIndex])){for(var r=t[n].fromRelation[t[n].fromRelation.length-1],o=t[n].direction[t[n].direction.length-1],l=this.ontoController.getLastElementUri(r,o);!1!==this.ontoController.getCardinalElement(l,!1);)l=this.ontoController.getCardinalElement(l,!1);l=this.ontoController.getOntoElement(l);var i=this.ontoController.getOntoBranch(r,o),a=!0,s=!1,u=void 0;try{for(var h,c=i[Symbol.iterator]();!(a=(h=c.next()).done);a=!0){var d=h.value;this.ontoController.addToProperty(d.uri,"fromRelation",this.relation.uri.value),this.ontoController.addToProperty(d.uri,"direction",this.ruleKey)}}catch(p){s=!0,u=p}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}return[l,!1]}this.relationIndex--,n=0}return e=void 0!==(e=this.relationTree[this.relationIndex])&&e,this.relationIndex--,e}},{key:"areChildrenInBranchUseless",value:function(e){return!e.childRel.includes("http://lod2-dev.vse.cz/ontology/puro#subTypeOf")}},{key:"isElementInstace",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,l=this.queryTree[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var i=o.value;if(e.uri.value===i.uri.value){var a=!0,s=!1,u=void 0;try{for(var h,c=i.fatherTypeRelation[Symbol.iterator]();!(a=(h=c.next()).done);a=!0){var d=h.value;if("instanceOf"===this.delUri(d))return!0}}catch(p){s=!0,u=p}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}}}}catch(p){n=!0,r=p}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}return!1}},{key:"checkElementsConsistency",value:function(e,t){var n=this.ontoController.getOntoModel(),r=0,o=[],l=!0,i=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(l=(s=u.next()).done);l=!0){var h=s.value;h.fromRelation.includes(e)&&h.direction[h.direction.length-1]===t&&h.branchIndex.includes(this.relationRuleIndex)&&o.push(h)}}catch(d){i=!0,a=d}finally{try{l||null==u.return||u.return()}finally{if(i)throw a}}if(0===o.length)return o;this.ontoController.getOntoElement(this.relation.uri.value);var c=this.ruleController.elementConsistencyRules(o[r],this.ontoController);for(r++;r<o.length&&0===c.length;)c=this.ruleController.elementConsistencyRules(o[r],this.ontoController),r++;return c}},{key:"isElementUseless",value:function(e){return"child"in e&&0===e.child.length&&0===e.connect.length&&0===e.connectFrom.length}},{key:"getElementByUri",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,l=this.queryTree[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var i=o.value;if(i.uri.value===e)return i}}catch(a){n=!0,r=a}finally{try{t||null==l.return||l.return()}finally{if(n)throw r}}return!1}},{key:"changeElementsProperty",value:function(e,t,n){for(var r=0;r<this.queryTree.length;r++)if(this.queryTree[r].uri.value===e)return this.queryTree[r][t].value=n,!0;return!1}},{key:"checkDuplicity",value:function(e){return this.ontoController.checkDuplicity(e)}},{key:"getConnectedElements",value:function(e,t){var n=[],r=!0,o=!1,l=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value,u=this.ontoController.getElementOntoType(s);if(!1===u||e[this.ruleIndex].connect.includes(u)){var h=!1!==u?this.delUri(s)+" ["+u+"]":this.delUri(s);n.push({name:h,uri:s})}}}catch(c){o=!0,l=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw l}}return n}},{key:"setIndexexToDefault",value:function(){this.valuationArr=null,this.relationRuleIndex=0,this.relationTree={},this.relationTreeIndex=0,this.relationTreeArr=[],this.elementsWithoutType=[],this.withoutTypeIndex=0,this.elementConsistencyIndex=0,this.elementConsitencyTree=[],this.elementUri="",this.ruleKey="",this.type="",this.selectedEl={},this.elSettings={},this.lastElInBranch=!1,this.additionalRule={key:void 0,rule:{},index:1},this.consistencyExeption=[]}},{key:"saveHistory",value:function(e,t){if(0===this.historyController.propertiesHistory.length){var n={};for(var r in e)"queryTree"===e[r]?n[r]=JSON.parse(JSON.stringify(this.queryTree)):"string"===typeof e[r]?n[r]="":"number"===typeof e[r]?n[r]=0:Array.isArray(e[r])?n[r]=[]:"object"===typeof e[r]&&(n[r]={});this.historyController.init(n)}this.historyController.saveRecords(e,JSON.parse(JSON.stringify(this.ontoController.getOntoModel())),t)}},{key:"undo",value:function(){var e=this.historyController.undo();if(void 0===e.ontoModel&&void 0===e.properties)return this.historyController.reset(),this.ontoController.undo([]),this.setIndexexToDefault(),this.elSettings={},this.relationOrderIndex=0,this.relationRuleIndex=0,this.relation={},this.relationIndex=0,this.relationType="",!1;for(var t in this.ontoController.undo(e.ontoModel),console.log(JSON.parse(JSON.stringify(this.additionalRule))),e.properties)"object"===typeof e.properties[t]?(console.log(t),console.log(JSON.parse(JSON.stringify(this[t]))),this[t]=JSON.parse(JSON.stringify(e.properties[t]))):this[t]=e.properties[t];return console.log(JSON.parse(JSON.stringify(this.additionalRule))),{inputVariables:e.inputVariables}}},{key:"getOntoSchema",value:function(){return this.ontoSchemaController.transform(this.ontoController.getOntoModel())}}]),t}(C),I=n(204),U=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(a.a)(t).call(this,e))).createGraph=function(e){n.setState({svg:e})},n.state={svg:""},n.eventController=new w,g.a.initialize({startOnLoad:!1,themeCSS:"#extensionEnd { fill: white; } #extensionStart { fill: white; }"}),n}return Object(s.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:"container"},h.a.createElement("div",{className:"row"},h.a.createElement("div",{className:"form-group col-md-6",id:"graph"},h.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},"Puro model"),h.a.createElement("div",{className:"form-control  transformWindow embed-responsive",id:"exampleFormControlTextarea1"},h.a.createElement("img",{src:n(867),className:"img-fluid",alt:"puro-model"}))),h.a.createElement("div",{className:"form-group col-md-6",id:"graph"},h.a.createElement(I.b,{enablePadding:!1},(function(t){t.zoomIn,t.zoomOut;var n=t.resetTransform;Object(r.a)(t,["zoomIn","zoomOut","resetTransform"]);return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"tools"},h.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},"Onto model"),h.a.createElement("button",{className:"toolBtn btn-sm btn-light",onClick:n},"Unzoom")),h.a.createElement("div",{className:"border"},h.a.createElement(I.a,null,h.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.state.svg},className:"transformWindow",id:"exampleFormControlTextarea1"}))))}))),h.a.createElement(B,{graphCreation:this.createGraph})))}}]),t}(h.a.Component),B=(h.a.Component,h.a.Component,function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(a.a)(t).call(this,e))).handleChange=function(e){n.setState({elName:e.target.value})},n.handleSubmit=function(e){void 0!==e&&e.preventDefault(),n.eventController.getDefault().then((function(e){n.setState({undoActive:!1,svgUrl:"",buttons:e.buttons,title:e.title,originalName:e.originalName,type:e.type,startTransform:!1})}))},n.undoClick=function(){},n.handleClick=function(e,t,r){var o=n.state.elName,l=!1,i=!0,a=n.state.nameWasChange;if(""===o&&!0===n.state.changeName&&"Undo"!==r&&"none"!==e.toLowerCase())alert("Plese write name of the element!");else if(""===o||o.match(/^[A-Za-z0-9-_*<>]+$/)){if("Undo"===r){var s=n.eventController.undo();if(!1===s)n.handleSubmit(),i=!1;else{var u=s.inputVariables;e=u[0],t=u[1],r=u[2],o=u[3],a=u[4],l=!0}}""===(o=o.replace(/\s/g,"_"))||!0!==n.state.changeName||n.eventController.checkDuplicity(o)?!0===i&&n.eventController.nextElement(e,t,r,o,a).then((function(i){if(!1===l){var a=Object.getOwnPropertyNames(n.eventController),s={},u=!0,h=!1,c=void 0;try{for(var d,p=a[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var y=d.value;y.includes("Controller")||"rulesJson"===y||"relations"===y||"function"!==typeof y&&(s[y]=n.assignProp(n.eventController[y]))}}catch(v){h=!0,c=v}finally{try{u||null==p.return||p.return()}finally{if(h)throw c}}n.eventController.saveHistory(s,[e,t,r,o,n.state.nameWasChange])}var f=n.eventController.getGraphSvg();n.setState({buttons:i.buttons,type:i.type,title:i.title,undoActive:!0,elName:"",changeName:i.elName,originalName:i.originalName,nameWasChange:!1}),!1!==f&&n.createGraph(f),n.state.type.includes("end")&&n.handleDownloadImage()})):alert("Element already exists! Please choose different name.")}else alert("Please change the name. It contains forbidden characters!")},n.assignProp=function(e){return Array.isArray(e)||"object"===typeof e?JSON.parse(JSON.stringify(e)):e},n.createGraph=function(e){g.a.render("id1",e,(function(e){n.setState({svg:e}),n.props.graphCreation(e)}))},n.handleChangeName=function(){n.setState({changeName:!n.state.changeName}),!0===n.state.changeName?(n.setState({elName:"",nameWasChange:!1}),y()(".changeAlert").fadeTo(1400,500).slideUp(500,(function(){y()(".changeAlert").alert("fade")}))):n.setState({elName:"",nameWasChange:!0})},n.handleDownloadImage=function(){var e=new Blob([n.state.svg],{type:"image/svg+xml;charset=utf-8"}),t=URL.createObjectURL(e);n.setState({svgUrl:t})},n.handleDownloadSchema=function(){var e=JSON.stringify(n.eventController.getOntoSchema());v()(e,"ontoSchema.json")},n.state={startTransform:!0,originalName:"",nameWasChange:!1,buttons:[],changeName:!1,elName:"",type:"",undoActive:!1,svg:""},n.eventController=new w,n}return Object(s.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:"container-fluid text-center questionPart"},h.a.createElement("button",{type:"Submint",className:this.state.startTransform?"btn btn-primary":"d-none","data-toggle":"modal","data-target":"#exampleModal",onClick:this.handleSubmit},"Start transformation"),h.a.createElement("div",{className:this.state.startTransform?"d-none":""},h.a.createElement("h3",{className:"questionTitle"},this.state.title),h.a.createElement("div",{className:"optionButtons d-none d-md-block"},h.a.createElement("div",{className:"btn-group-vertical text-right"},h.a.createElement("button",{type:"button",className:"btn btn-primary btnModal",onClick:this.handleChangeName,disabled:""===this.state.originalName||this.state.type.includes("ontoRelation")||this.state.type.includes("end")||"nextBranchElements"===this.state.type},!0===this.state.changeName&&""!==this.state.originalName?"Set original name":"Change name"),h.a.createElement("button",{type:"button",className:"btn btn-primary btnModal",onClick:function(){return e.handleClick(void 0,void 0,"Undo")},disabled:!this.state.undoActive},"Undo"),h.a.createElement("button",{type:"button",className:"btn btn-secondary btnModal","data-dismiss":"modal",onClick:function(e){window.confirm("Are you sure you want to cancel the transformation?")&&window.location.reload()}},"Cancel"))),h.a.createElement("div",{className:!0===this.state.changeName?"col-md-6 mx-auto":"d-none"},h.a.createElement("div",{className:"input-group inputName"},h.a.createElement("div",{className:"input-group-prepend"},h.a.createElement("span",{className:"input-group-text",id:""},"Name of the element:")),h.a.createElement("input",{placeholder:""===this.state.originalName?"Write name of the element!":this.state.originalName,type:"text",className:"form-control",onChange:this.handleChange,value:this.state.elName})),h.a.createElement("h5",{className:this.state.buttons.lenght>1?"text-center inputName":"d-none"},"Select element's class:")),h.a.createElement("div",{className:"divButtons text-center"},h.a.createElement(M,{buttons:this.state.buttons,onClickDownloadSchema:this.handleDownloadSchema,svgUrl:this.state.svgUrl,onClick:this.handleClick,type:this.state.type,elNames:this.state.changeName,originalName:this.state.originalName})),h.a.createElement("div",{class:"alert alert-success col-md-6 mx-auto changeAlert",role:"alert"},"Original name of the element was set!")))}}]),t}(h.a.Component)),M=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(a.a)(t).call(this,e))).refs=h.a.createRef(),n}return Object(s.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.type.includes("ontoRelation-save")?h.a.createElement("div",{className:"row col-md-5 mx-auto"},h.a.createElement("label",{className:"label label-default col-md-6 mx-auto form-control"},this.props.elNames[0]),h.a.createElement("label",{className:"label label-default col-md-6 mx-auto form-control"},this.props.elNames[1]),h.a.createElement("select",{ref:"relFrom",className:"col-md-6 mx-auto form-control cardinalitySelect"},this.props.buttons.filter((function(e){return"from"===e.direction})).map((function(e){return h.a.createElement("option",{value:e.name},e.name)}))),h.a.createElement("select",{ref:"relTo",className:"col-md-6 mx-auto form-control cardinalitySelect"},this.props.buttons.filter((function(e){return"to"===e.direction})).map((function(e){return h.a.createElement("option",{value:e.name},e.name)}))),h.a.createElement("button",{className:"btn btn-success mx-auto questionPart",onClick:function(){return e.props.onClick([e.refs.relFrom.value,e.refs.relTo.value],null,e.props.type)}},"Next")):this.props.type.includes("end")?h.a.createElement("div",{className:"col-md-8 mx-auto"},h.a.createElement("a",{className:"btn btn-success btnEnd",href:this.props.svgUrl,download:"ontoUml-graph.svg"},"Download Onto-UML graph"),h.a.createElement("button",{type:"button",className:"btn btn-success btnEnd",onClick:function(){return e.props.onClickDownloadSchema()}},"Download Onto-Schema")):h.a.createElement("div",{className:"row col-md-6 mx-auto"},this.props.buttons.map((function(t){return h.a.createElement("div",{className:"col-md-4 mx-auto"},h.a.createElement("button",{key:e.props.uri,type:"button",className:"none"===t.name.toLowerCase()?" btn btn-secondary btnModal":"btn btn-success btnModal",onClick:function(){return e.props.onClick(t.name,t.uri,e.props.type,t.origin)}},e.props.type.includes("dataType")||""===e.props.originalName&&1===e.props.buttons.length||"relator"===t.name.toLowerCase()&&1===e.props.buttons.length?"Next":t.name))})))}}]),t}(h.a.Component),L=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return[h.a.createElement(U,null)]}}]),t}(h.a.Component);d.a.render(h.a.createElement(L,null),document.getElementById("root"))}},[[380,1,2]]]);
//# sourceMappingURL=main.f5a28bc4.chunk.js.map